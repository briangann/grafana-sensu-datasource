{"version":3,"sources":["../../src/event_functions.js"],"names":["getEventsURIs","checkNames","clientNames","URIs","dimensionURI","aClientName","aCheckName","anAggregateName","length","i","push","j","convertEventsToDataPoints","aTarget","responses","response","data","undefined","singleData","filteredData","anEvent","datapoints","startingTimestamp","timestamp","check","history","last_execution","y","target","client","name","clientName","includeEventTarget","silenced","hideSilencedEvents","newResponse","convertEventsToJSON","issued","clientShortname","parts","split","client_short_name","statusText","status","status_text","check_name","occurrences","occurrences_watermark","action","id","last_state_change","last_ok","silenced_by","executed","err","type","convertEventsToEventMetricsJSON","eventMetrics","numEvents","numSilenced","numClientsSilenced","numChecksSilenced","numWarningEvents","numWarningEventsSilenced","numCriticalEvents","numCriticalEventsSilenced","numUnknownEvents","numUnknownEventsSilenced","indexOf","filters","aFilter","filterType","hasOwnProperty","filterFieldName","aVal","filterFieldValueReplaced","convertEventsToEventMetrics","targetName","aliasReplaced","eventMetricMode"],"mappings":"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","file":"event_functions.js","sourcesContent":["/**\n *\n */\nimport { getResponseForTarget } from './common';\n\n function getEventsURIs(checkNames, clientNames) {\n   // https://sensuapp.org/docs/0.28/api/events-api.html\n   var URIs = [];\n   var dimensionURI = '/events';\n   var aClientName = null;\n   var aCheckName = null;\n   var anAggregateName = null;\n   if (clientNames.length) {\n     for (let i = 0; i < clientNames.length; i++) {\n       aClientName = clientNames[i];\n       dimensionURI = '/events/' + aClientName;\n       URIs.push(dimensionURI);\n     }\n   }\n   if ((checkNames.length) && (clientNames.length)) {\n     for (let i = 0; i < clientNames.length; i++) {\n       aClientName = clientNames[i];\n       for (let j = 0; j < checkNames.length; j++) {\n         aCheckName = checkNames[i];\n         dimensionURI = '/events/' + aClientName + '/' + aCheckName;\n         URIs.push(dimensionURI);\n       }\n     }\n   }\n   if (URIs.length === 0) {\n     URIs.push(dimensionURI);\n   }\n   return URIs;\n }\n\n\n/**\n * [convertEventsToDataPoints description]\n * @param  {[type]} response [description]\n * @return {[type]}        [description]\n */\nfunction convertEventsToDataPoints(aTarget, responses) {\n  var response = getResponseForTarget(aTarget, responses);\n\n  // convert history to datapoints\n\n  // the result has no \"datapoints\", need to create it based on the check data\n\n  // when we have a checkname and an clientName, the response is different, the\n  // data is not an array, but contains the same information, recreate and push\n  if (response.data.length === undefined) {\n    var singleData = response.data;\n    response.data = [];\n    response.data.push(singleData);\n  }\n  var filteredData = [];\n  for (var i = 0; i < response.data.length; i++) {\n    var anEvent = response.data[i];\n    var datapoints = [];\n    var startingTimestamp = 0;\n    // an event with client param has a timestamp at the toplevel\n    if (anEvent.timestamp !== undefined) {\n      startingTimestamp = anEvent.timestamp - (60 * anEvent.check.history.length);\n    }\n    if (anEvent.last_execution !== undefined) {\n      startingTimestamp = anEvent.last_execution - (60 * anEvent.history.length);\n    }\n    // time needs to be in MS, we get EPOCH from Sensu\n    for (var y = 0; y < anEvent.check.history.length; y++) {\n      datapoints[y] = [anEvent.check.history[y], (startingTimestamp + (60 * y)) * 1000];\n    }\n    anEvent.datapoints = datapoints;\n    // set the target to be the check name\n    anEvent.target = anEvent.client.name;\n    /*\n    if (anEvent.check.name !== undefined) {\n      anEvent.target = anEvent.check.name;\n    } else {\n      anEvent.target = anEvent.check;\n    }\n    */\n    //debugger;\n    anEvent.clientName = anEvent.client.name;\n    if (includeEventTarget(aTarget, anEvent)) {\n      if (!anEvent.silenced) {\n        filteredData.push(anEvent);\n      }\n      if (anEvent.silenced && !aTarget.hideSilencedEvents) {\n        filteredData.push(anEvent);\n      }\n    }\n  }\n  var newResponse = { data: filteredData };\n\n  return newResponse;\n}\n\n\nfunction convertEventsToJSON(aTarget, responses) {\n  /*jshint -W087 */\n  //debugger;\n  var response = getResponseForTarget(aTarget, responses);\n  // do not allow modification of response\n  //var newResponse = {};\n\n  var filteredData = [];\n  for (var i = 0; i < response.data.length; i++) {\n    var anEvent = response.data[i];\n    var datapoints = [];\n    //console.log(JSON.stringify(anEvent));\n    if ((anEvent.check.issued !== undefined) && includeEventTarget(aTarget, anEvent)) {\n      var clientShortname = anEvent.client.name;\n      // try to split on dot notation, take the first item\n      var parts = anEvent.client.name.split(\".\");\n      if (parts.length > 0) {\n        clientShortname = parts[0];\n      }\n      anEvent.client.client_short_name = clientShortname;\n      // now create text-based version of status\n      var statusText = \"UNKNOWN\";\n      if ((anEvent.check !== undefined) && (anEvent.check.status !== undefined)) {\n        switch (anEvent.check.status) {\n          case 0:\n            statusText = \"OK\";\n            break;\n          case 1:\n            statusText = \"WARNING\";\n            break;\n          case 2:\n            statusText = \"CRITICAL\";\n            break;\n          case 3:\n            statusText = \"UNKNOWN\";\n            break;\n          default:\n            statusText = \"UNKNOWN\";\n            break;\n        }\n      }\n      anEvent.check.status_text = statusText;\n      var data = {\n        timestamp: (anEvent.check.issued * 1000),\n        check_name: anEvent.check.name,\n        client: anEvent.client,\n        check: anEvent.check,\n        occurrences: anEvent.occurrences,\n        occurrences_watermark: anEvent.occurrences_watermark,\n        action: anEvent.action,\n        id: anEvent.id,\n        last_state_change: (anEvent.last_state_change * 1000),\n        last_ok: (anEvent.last_ok * 1000),\n        silenced: anEvent.silenced,\n        silenced_by: anEvent.silenced_by\n      };\n      try {\n        data.check.issued = data.check.issued * 1000;\n        data.check.executed = data.check.executed * 1000;\n      } catch (err) {\n        // do nothing\n      }\n      datapoints.push(data);\n      anEvent.datapoints = datapoints;\n      delete anEvent.check;\n      delete anEvent.client;\n      anEvent.type = 'docs';\n      if (!anEvent.silenced) {\n        filteredData.push(anEvent);\n      }\n      if (anEvent.silenced && !aTarget.hideSilencedEvents) {\n        filteredData.push(anEvent);\n      }\n    }\n  }\n  var newResponse = { data: filteredData };\n\n  //var str = JSON.stringify(newResponse, null, 2);\n  //console.log(str);\n  /*jshint -W087 */\n  //debugger;\n  return newResponse;\n}\n\n/**\n * The takes /events output from Sensu and returns the following:\n * Count of WARNING, and Number Silenced\n * Count of CRITICAL, and number silenced\n * Count of UNKNOWN, and number silenced\n * Count of all Events\n * Count of all Events not Silenced\n * Count of all Silenced Events\n * Count of Clients Silenced\n * Count of Checks Silenced\n *\n * Filters are also applied\n *\n * @param  {[type]} target   [description]\n * @param  {[type]} response [description]\n * @return {[type]}          [description]\n */\nfunction convertEventsToEventMetricsJSON(aTarget, responses) {\n  var response = getResponseForTarget(aTarget, responses);\n\n  // timestamp is taken from first item in response\n  var timestamp = 0;\n  try {\n    timestamp = response.data[0].check.issued * 1000;\n  } catch (err) {\n    // do nothing\n  }\n  var eventMetrics = {\n    target: \"allEvents\",\n    timestamp: timestamp,\n    numEvents: 0,\n    numSilenced: 0,\n    numClientsSilenced: 0,\n    numChecksSilenced: 0,\n    numWarningEvents: 0,\n    numWarningEventsSilenced: 0,\n    numCriticalEvents: 0,\n    numCriticalEventsSilenced: 0,\n    numUnknownEvents: 0,\n    numUnknownEventsSilenced: 0\n  };\n  var clientNames = [];\n  var checkNames = [];\n  for (var i = 0; i < response.data.length; i++) {\n    var anEvent = response.data[i];\n    if (anEvent.check.issued !== undefined) {\n      if ((anEvent.check !== undefined) && (anEvent.check.status !== undefined) && includeEventTarget(aTarget, anEvent)) {\n        eventMetrics.numEvents += 1;\n        switch (anEvent.check.status) {\n          case 1:\n            eventMetrics.numWarningEvents += 1;\n            if (anEvent.silenced) {\n              eventMetrics.numWarningEventsSilenced += 1;\n              eventMetrics.numSilenced += 1;\n            }\n            break;\n          case 2:\n            eventMetrics.numCriticalEvents += 1;\n            if (anEvent.silenced) {\n              eventMetrics.numCriticalEventsSilenced += 1;\n              eventMetrics.numSilenced += 1;\n            }\n            break;\n          default:\n            eventMetrics.numUnknownEvents += 1;\n            if (anEvent.silenced) {\n              eventMetrics.numUnknownEventsSilenced += 1;\n              eventMetrics.numSilenced += 1;\n            }\n            break;\n        }\n      }\n      // store the client names to count later\n      if (clientNames.indexOf(anEvent.client.name) < 0) {\n        clientNames.push(anEvent.client.name);\n      }\n      // store the check names to count later\n      if (checkNames.indexOf(anEvent.check.name) < 0) {\n        checkNames.push(anEvent.check.name);\n      }\n      // inspect silenced_by for clientname:*, wich means the client is silenced\n      for (let i = 0; i < anEvent.silenced_by.length; i++) {\n        if (anEvent.silenced_by[i].indexOf('*')) {\n          eventMetrics.numClientsSilenced += 1;\n        }\n        else {\n          eventMetrics.numChecksSilenced += 1;\n        }\n      }\n    }\n  }\n  eventMetrics.numClientsSilenced = clientNames.length;\n  eventMetrics.numChecksSilenced = checkNames.length;\n  response.data = [{\n    target: \"allEvents\",\n    timestamp: timestamp,\n    type: 'docs',\n    datapoints: [eventMetrics]\n  }];\n  //var str = JSON.stringify(response, null, 2);\n  //console.log(str);\n  /*jshint -W087 */\n  //debugger;\n  //var x = response.data[0].datapoints[0][1];\n  //console.log(\"X = \" + x);\n  return response;\n}\n\n/**\n * No fields means it is a match\n * @param  {[type]}  target [description]\n * @return {Boolean}        [description]\n */\nfunction includeEventTarget(target, anEvent) {\n  /*jshint -W087 */\n  //debugger;\n  if (target.filters === undefined) {\n    return true;\n  }\n  if (target.filters.length === 0) {\n    return true;\n  }\n  for (var i = 0; i < target.filters.length; i++) {\n    var aFilter = target.filters[i];\n    switch (aFilter.filterType) {\n      case 'field':\n        // filterFieldName\n        // filterFieldValue\n        if (anEvent.client.hasOwnProperty(aFilter.filterFieldName)) {\n          // matched field, check value\n          var aVal = anEvent.client[aFilter.filterFieldName];\n          if (aVal === aFilter.filterFieldValueReplaced) {\n            return true;\n          }\n        }\n        break;\n    }\n  }\n  return false;\n}\n\n/**\n * [convertEventsToEventMetrics description]\n * @param  {[type]} aTarget   [description]\n * @param  {[type]} responses [description]\n * @return {[type]}           [description]\n */\nfunction convertEventsToEventMetrics(aTarget, responses) {\n  // find a response that matches the target\n  /*jshint -W087 */\n  //debugger;\n  var response = getResponseForTarget(aTarget, responses);\n  var newResponse = {};\n  // timestamp is taken from first item in response\n  var timestamp = 0;\n  try {\n    timestamp = response.data[0].check.issued * 1000;\n  } catch (err) {\n    // do nothing\n  }\n  var eventMetrics = {\n    target: \"allEvents\",\n    timestamp: timestamp,\n    numEvents: 0.0,\n    numSilenced: 0.0,\n    numClientsSilenced: 0.0,\n    numChecksSilenced: 0.0,\n    numWarningEvents: 0.0,\n    numWarningEventsSilenced: 0.0,\n    numCriticalEvents: 0.0,\n    numCriticalEventsSilenced: 0.0,\n    numUnknownEvents: 0.0,\n    numUnknownEventsSilenced: 0.0\n  };\n  var clientNames = [];\n  var checkNames = [];\n  for (var i = 0; i < response.data.length; i++) {\n    var anEvent = response.data[i];\n    if (anEvent.check.issued !== undefined) {\n      if ((anEvent.check !== undefined) && (anEvent.check.status !== undefined) && includeEventTarget(aTarget, anEvent)) {\n        eventMetrics.numEvents += 1.0;\n        switch (anEvent.check.status) {\n          case 1:\n            eventMetrics.numWarningEvents += 1.0;\n            if (anEvent.silenced) {\n              eventMetrics.numWarningEventsSilenced += 1.0;\n              eventMetrics.numSilenced += 1.0;\n            }\n            break;\n          case 2:\n            eventMetrics.numCriticalEvents += 1.0;\n            if (anEvent.silenced) {\n              eventMetrics.numCriticalEventsSilenced += 1.0;\n              eventMetrics.numSilenced += 1.0;\n            }\n            break;\n          default:\n            eventMetrics.numUnknownEvents += 1.0;\n            if (anEvent.silenced) {\n              eventMetrics.numUnknownEventsSilenced += 1.0;\n              eventMetrics.numSilenced += 1.0;\n            }\n            break;\n        }\n      }\n      // store the client names to count later\n      if (clientNames.indexOf(anEvent.client.name) < 1.0) {\n        clientNames.push(anEvent.client.name);\n      }\n      // store the check names to count later\n      if (checkNames.indexOf(anEvent.check.name) < 1.0) {\n        checkNames.push(anEvent.check.name);\n      }\n      // inspect silenced_by for clientname:*, wich means the client is silenced\n      for (let i = 0; i < anEvent.silenced_by.length; i++) {\n        if (anEvent.silenced_by[i].indexOf('*')) {\n          eventMetrics.numClientsSilenced += 1.0;\n        }\n        else {\n          eventMetrics.numChecksSilenced += 1.0;\n        }\n      }\n    }\n  }\n  eventMetrics.numClientsSilenced = clientNames.length;\n  eventMetrics.numChecksSilenced = checkNames.length;\n\n  /*jshint -W087 */\n  //debugger;\n  var targetName = null;\n  if (aTarget.name !== undefined) {\n    targetName = aTarget.name;\n  }\n  if (aTarget.aliasReplaced !== undefined) {\n    targetName = aTarget.aliasReplaced;\n  }\n  newResponse.data = [{\n    target: targetName,\n    datapoints: [\n      [ 0.00, timestamp ]\n    ]\n  }];\n  switch (aTarget.eventMetricMode) {\n    case 'all_events_count':\n      if (targetName === null) {\n        newResponse.data[0].target = \"all_events_count\";\n      }\n      newResponse.data[0].datapoints = [[ eventMetrics.numEvents, timestamp]];\n      break;\n    case 'active_events_count':\n      if (targetName === null) {\n        newResponse.data[0].target = \"active_events_count\";\n      }\n      newResponse.data[0].datapoints = [[ eventMetrics.numEvents - eventMetrics.numSilenced, timestamp]];\n      break;\n    case 'critical_count':\n      if (targetName === null) {\n        newResponse.data[0].target = \"critical_events_count\";\n      }\n      newResponse.data[0].datapoints = [[ eventMetrics.numCriticalEvents, timestamp]];\n      break;\n    case 'critical_active_count':\n      if (targetName === null) {\n        newResponse.data[0].target = \"critical_active_count\";\n      }\n      newResponse.data[0].datapoints = [[ eventMetrics.numCriticalEvents - eventMetrics.numCriticalEventsSilenced, timestamp]];\n      break;\n    case 'critical_silenced_count':\n      if (targetName === null) {\n        newResponse.data[0].target = \"critical_silenced_count\";\n      }\n      newResponse.data[0].datapoints = [[ eventMetrics.numCriticalEventsSilenced, timestamp]];\n      break;\n    case 'warning_count':\n      if (targetName === null) {\n        newResponse.data[0].target = \"warning_events_count\";\n      }\n      newResponse.data[0].datapoints = [[ eventMetrics.numWarningEvents, timestamp]];\n      break;\n    case 'warning_active_count':\n      if (targetName === null) {\n        newResponse.data[0].target = \"warning_active_count\";\n      }\n      newResponse.data[0].datapoints = [[ eventMetrics.numWarningEvents - eventMetrics.numWarningEventsSilenced, timestamp]];\n      break;\n    case 'warning_silenced_count':\n      if (targetName === null) {\n        newResponse.data[0].target = \"warning_silenced_count\";\n      }\n      newResponse.data[0].datapoints = [[ eventMetrics.numWarningEventsSilenced, timestamp]];\n      break;\n    case 'unknown_count':\n      if (targetName === null) {\n        newResponse.data[0].target = \"unknown_events_count\";\n      }\n      newResponse.data[0].datapoints = [[ eventMetrics.numUnknownEvents, timestamp]];\n      break;\n    case 'unknown_active_count':\n      if (targetName === null) {\n        newResponse.data[0].target = \"unknown_active_count\";\n      }\n      newResponse.data[0].datapoints = [[ eventMetrics.numUnknownEvents - eventMetrics.numUnknownEventsSilenced, timestamp]];\n      break;\n    case 'unknown_silenced_count':\n      if (targetName === null) {\n        newResponse.data[0].target = \"unknown_silenced_count\";\n      }\n      newResponse.data[0].datapoints = [[ eventMetrics.numUnknownEventsSilenced, timestamp]];\n      break;\n    case 'silenced_count':\n      if (targetName === null) {\n        newResponse.data[0].target = \"silenced_events_count\";\n      }\n      newResponse.data[0].datapoints = [[ eventMetrics.numSilenced, timestamp]];\n      break;\n    case 'clients_silenced_count':\n      if (targetName === null) {\n        newResponse.data[0].target = \"clients_silenced_count\";\n      }\n      newResponse.data[0].datapoints = [[ eventMetrics.numClientsSilenced, timestamp]];\n      break;\n    case 'checks_silenced_count':\n      if (targetName === null) {\n        newResponse.data[0].target = \"checks_silenced_count\";\n      }\n      newResponse.data[0].datapoints = [[ eventMetrics.numChecksSilenced, timestamp]];\n      break;\n    default:\n      if (targetName === null) {\n        newResponse.data[0].target = \"all_events_count\";\n      }\n      newResponse.data[0].datapoints = [[ eventMetrics.numEvents, timestamp]];\n      break;\n  }\n  //var str = JSON.stringify(newResponse, null, 2);\n  //console.log(str);\n  return newResponse;\n}\n\nexport {\n  convertEventsToJSON,\n  convertEventsToDataPoints,\n  convertEventsToEventMetrics,\n  convertEventsToEventMetricsJSON,\n  getEventsURIs,\n  includeEventTarget\n};\n"]}